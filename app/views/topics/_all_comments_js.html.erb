<% ordered_resource(@topic.comments).each do |comment| %>
  <h4><%= User.find(comment.user_id).full_name %></h4>
  <p><%= comment.content %></p>

  <% if is_own_comment?(comment) %>
    <%= link_to 'Edit', edit_vacation_topic_comment_path(current_vacation, current_topic, comment) %>
    <%= link_to 'Delete', [current_vacation, current_topic, comment], :confirm => 'Are you sure?', :method => :delete %>
  <% elsif has_superiority?(comment) %>
    <%= link_to 'Delete', [current_vacation, current_topic, comment], :confirm => 'Are you sure?', :method => :delete %>
  <% end %>
  <%= link_to 'Back', vacation_path(current_vacation) %>
<% end %>

<% if @topic.is_open %>
  <h2>Write a Comment</h2>
  <%= form_for([current_vacation, current_topic, @comment]) do |f| %>
    <div class="field">
      <%= f.label :content %><br />
      <%= f.text_field :content %>
    </div>
    <div class="actions">
      <%= hidden_field_tag 'user_id', current_user.id %>
      <%= f.submit class: 'btn btn-default'%>
    </div>
  <% end %>
<% end %>

<% if is_not_rooming? %>
  <% if current_user.is_admin %>
    <% if @topic.is_open %>
      <%= form_for([@topic.vacation, @topic], {:method => 'put'}) do |f| %>
        <div class="actions">
          <%= f.hidden_field(:is_open, :value => false) %>
          <%= f.submit :value => "Close Form", class: 'btn btn-primary' %>
        </div>
      <% end %>
    <% end %>
  <% end %>
<% end %>
